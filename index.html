<html>
	<head>
		<title>Tether, Take SL Music With You!</title>
		<script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>
		<script src='https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js'></script>
		<script src="https://tether.corehoundsystem.com/Headerscript.js"></script>
		<script src="https://tether.corehoundsystem.com/Channelscript.js"></script>
		<script src="https://apis.google.com/js/platform.js" async defer></script>
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141646766-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('set', {'user_id': 'USER_ID'});
			gtag('config', 'UA-141646766-1');
		</script>
		<meta name="google-signin-client_id" content="833721381252-smfnva31dl66h8n6ffikc99f50ff4dqo.apps.googleusercontent.com">
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:site" content="@handle">
		<meta name="twitter:creator" content="@handle">
		<meta name="twitter:title" content="Tether, Take SL Music With You!">
		<meta name="twitter:image" content="https://image">
		<meta name="og:title" content="Tether, Take SL Music With You!">
		<meta name="og:description" content="Listen to your favorite SL musicians anywhere, anytime.">
		<meta name="og:image" content="https://image">
		<meta name="og:locale" content="en_US">
		<meta name="og:site_name" content="Tether">
		<meta name="og:url" content="https://tether.corehoundsystem.com">
		<meta name="description" content="Listen to your favorite SL musicians anywhere, anytime.">
		<meta name="keywords" content="second life,music,live,cover,original">
		<meta name="language" content="English">
		<meta name="copyright" content="Tether, LLC">
		<meta name="web_author" content="Core Hound System, LLC">
		<meta http-equiv="window-target" content="_top">
	</head>
	<body>
		<script id="libraryScripts">
			testMode=1;
			syncURL="https://docs.google.com/forms/d/e/1FAIpQLSe-bJWth2cKQ7-jo0vOHD_mSaIQIQfJN4aFcskKBfMaeH7zhw/formResponse?usp=pp_url&entry.762123824=";
			userSyncs="1GDyPff8QkQynVWfOWZIFNli4Lz8NtScWPc1U5uIwOOM";
			chanKey="1i9SfwLkDj40yOqOmRMAhe4FXI5fjjjyufx8Nz_IPKbg";
			songArtistKey="1EHmHCY8-n9wVSkimbL2k7d7NMZDo8xSsrtIuaRRJwNM";
			
			function cL(x) {
				if(testMode>=1) {
					console.log(x);
				}
				if(testMode==2) {
					$('body').append(x);
				}
			}
			
			function nextFunction(z) {
				cL("Got to the next function!");
				if(z) {
					cL("There is match!");
				} else {
					cL("No match, we need to prompt for a sync.");
					//prompt for sync
				}
			}
			
			function buildChannelStart() {
				$('body').append('<button id="ready">Ready?</button>');
				$('#ready').click(function() {
					startChannel(channels[0]);
					$('button').css('background','red');					
				});
			}
			
			function getObjects(x,y,z,f) {
				window[z]=[];
				$(function() {
					$.getJSON("https://spreadsheets.google.com/feeds/list/" + x + "/" + y + "/public/values?alt=json-in-script&callback=?",
					function (data) {
						$.each(data.feed.entry, function(i,entry) {
							window[z].push(JSON.parse(entry.gsx$item.$t.replace(/'/g, '"')));
						});
						if(f) {
							window[f](window[z]);
						}
					});
				});
			};
			
			function getString(x,y,z,c,f) {
				window[z]="";
				$(function() {
					$.getJSON("https://spreadsheets.google.com/feeds/list/" + x + "/" + y + "/public/values?alt=json-in-script&callback=?",
					function (data) {
						$.each(data.feed.entry, function(i,entry) {
							if(entry.gsx$data.$t.indexOf(c)!=-1) {
								window[z]=entry.gsx$data.$t;
							}
						});
						if(f) {
							window[f](window[z]);
						}
					});
					
				});
			};
			
			function loadUser(x) {
				getString(userSyncs,"1","syncObject",x+"|","nextFunction")
				getObjects(songArtistKey,"1","songs","nextFunction");
				getObjects(chanKey,"1","channels","buildChannelStart");
				
				//check if gID is sync'd
					//invite user to sync their SL avatar(s) - syncing allows avatars to use Tether in-world [and ad-free (if ads are ever implemented)?]
						//upon syncing account, check if they are an artist [or should the sync be used to determine that?] - allow upgrade to artist account at any time
							//if artist, load existing song data - requests by Tether and Tether users, approved songs with number of likes, submitted songs awaiting approval
				//getSongs
				//getUserChannels
			}
		</script>
		
		
		
		<div id="tetherHeader"></div>
		<div id="tetherBody">
			<div id="activeChannel"></div>
			
			<div class="g-signin2" data-onsuccess="onSignIn"></div>
			<a href="#" onclick="signOut();">Sign out</a>
			<script>
				$(function() {
					loadUser("110422615478236421761");
				});
				
				function onSignIn(googleUser) {
					var profile = googleUser.getBasicProfile();
					cL('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
					cL('Name: ' + profile.getName());
					cL('Image URL: ' + profile.getImageUrl());
					cL('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
					loadUser(profile.getId());
				}
				
				function signOut() {
					var auth2 = gapi.auth2.getAuthInstance();
					auth2.signOut().then(function () {
						cL('User signed out.');
					});
				}
			</script>
		</div>
		<div id="tetherFooter"></div>
	</body>
</html>
